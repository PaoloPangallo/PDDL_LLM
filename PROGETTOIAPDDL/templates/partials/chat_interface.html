<section class="result-section info">
    <h2>ğŸ—¨ï¸ Cronologia Conversazione</h2>
    <div class="chat-history-box">
        {% for msg in chat_history %}
            {% if msg.role == 'user' %}
                <div class="chat-bubble user"><strong>ğŸ‘¤ Tu:</strong> {{ msg.content }}</div>
            {% elif msg.role == 'assistant' %}
                <div class="chat-bubble assistant"><strong>ğŸ¤– LLM:</strong> {{ msg.content }}</div>
            {% endif %}
        {% endfor %}
    </div>
</section>

<section class="result-section">
    <h2>ğŸ’¬ Chatta con il Generatore</h2>
    <textarea id="userMessage" rows="3" placeholder="Es: il piano non ha senso, il drago non viene mai incontrato..."></textarea>
    <div style="margin: 10px 0;">
        <button id="useSuggestionBtn" type="button">ğŸ’¡ Usa suggerimento automatico</button>
        <button id="sendBtn">âœ‰ï¸ Invia Feedback</button>
    </div>
    <pre id="llmReply" class="readonly-textarea"></pre>

    <details class="result-section info" style="margin-top: 1rem;">
        <summary>ğŸ§¾ Anteprima completa del messaggio per l'LLM</summary>
        <pre id="fullPromptPreview" class="readonly-textarea" style="margin-top: 10px;"></pre>
        <button id="copyPromptBtn" type="button" style="margin-top: 10px;">ğŸ“‹ Copia Prompt</button>
    </details>

    {% if validation_json %}
    <details class="result-section info" style="margin-top: -10px;">
        <summary>ğŸ” Mostra il messaggio che verrÃ  inviato se lasci il campo vuoto</summary>
        <pre id="autoPromptPreview" class="readonly-textarea" style="margin-top: 10px;"></pre>
    </details>
    {% endif %}
</section>
